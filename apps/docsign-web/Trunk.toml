# Trunk configuration for docsign-web
# Run: trunk serve (dev) or trunk build --release (prod)

[build]
# Path to the input HTML file
target = "www/index.html"
# Output directory for build artifacts
dist = "www/dist"

# Pre-build hook: Compile TypeScript before Trunk builds
# This ensures www/js/bundle.js is up-to-date with src/ts/*.ts
[[hooks]]
stage = "pre_build"
command = "npm"
command_arguments = ["run", "build"]

[watch]
# Watch the wasm source, www directory, and TypeScript source
watch = ["wasm/src", "www", "src/ts"]
# Ignore paths that are within watched directories:
# - www/dist is the build output directory
# - www/js/bundle.js* are generated by the pre_build TypeScript hook
#   (otherwise the hook output triggers another rebuild in an infinite loop)
ignore = ["www/dist", "www/js/bundle.js", "www/js/bundle.js.map"]

[serve]
# Development server port
port = 8081
# Open browser on start
open = false

