# Trunk configuration for pdfjoin-web
# Run: trunk serve (dev) or trunk build --release (prod)

[build]
target = "www/index.html"
dist = "www/dist"

# Pre-build hook: Compile TypeScript before Trunk builds
# This ensures www/js/bundle.js is up-to-date with src/ts/*.ts
[[hooks]]
stage = "pre_build"
command = "npm"
command_arguments = ["run", "build"]

[watch]
watch = ["wasm/src", "www", "src/ts"]
# Ignore paths that are within watched directories:
# - www/dist is the build output directory
# - www/js/bundle.js* are generated by the pre_build TypeScript hook
#   (otherwise the hook output triggers another rebuild in an infinite loop)
ignore = ["www/dist", "www/js/bundle.js", "www/js/bundle.js.map"]

[serve]
port = 8082
open = false

# Test PDFs are symlinked in www/ and copied via index.html copy-file directives
